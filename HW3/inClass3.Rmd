---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

```{r}
library(mdsr)
library(tidyverse)
library(lubridate)
glimpse(Violations)
```
```{r}
ggplot(Violations) + geom_bar(aes(x = grade))
```
```{r}
dim(Violations)
```
```{r}
Violations %>% summarize(min(inspection_date), max(inspection_date))
```
```{r}
ggplot(Violations, aes(x = wday(inspection_date, label = TRUE))) +
  geom_bar() +
  theme_bw()


```
```{r}
ggplot(Violations %>% mutate(boro = as.factor(boro))) +
  geom_bar(aes(x = wday(inspection_date, label = TRUE))) +
  facet_grid('boro') + 
  theme_bw()
```
```{r}
join_violation <- Violations %>% full_join(ViolationCodes, by = 'violation_code')
glimpse(join_violation)
```
```{r}
ggplot(join_violation %>%  filter(critical_flag=='Critical') %>% mutate(boro = as.factor(boro))) +
  geom_bar(aes(x = wday(inspection_date, label = T))) +
  facet_grid('boro') + 
  theme_bw()
```
```{r}
Violations%>% filter(dba=="MORRIS PARK BAKE SHOP") %>% count(inspection_date,inspection_type)

```
```{r}
unique_inspections <- unique(Violations[c('camis','inspection_date')])
unique_inspections

```
```{r}
unique_inspection <- Violations %>% 
  full_join(ViolationCodes, by = 'violation_code') %>% 
  group_by(camis, inspection_date) %>% 
  summarise(dba = first(dba), 
            zipcode = first(zipcode), 
            boro = first(boro), 
            score = mean(score, na.rm = T), 
            grade = first(grade), 
            critical = any(critical_flag=='Critical'))
unique_inspection
```
```{r}
ggplot(unique_inspection %>% filter(critical == T)) +
  geom_bar(aes(x = wday(inspection_date, label = T))) + 
  #facet_grid(~boro) + 
  theme_bw()
```

